:root {
  --color-bg: #050910;
  --color-bg-elevated: #0e1520;
  --color-panel: #111a29;
  --color-panel-strong: #0b111c;
  --color-accent: #4f8cff;
  --color-accent-2: #8e7cff;
  --color-text: #f5f7ff;
  --color-muted: #8b95af;
  --color-border: #1f2b3c;
  --color-success: #66bb6a;
  --color-warning: #ffb74d;
  --color-danger: #ef5350;

  --rarity-common: #9e9e9e;
  --rarity-uncommon: #4caf50;
  --rarity-rare: #2196f3;
  --rarity-epic: #9c27b0;
  --rarity-legendary: #ff9800;

  --color-common: var(--rarity-common);
  --color-uncommon: var(--rarity-uncommon);
  --color-rare: var(--rarity-rare);
  --color-epic: var(--rarity-epic);
  --color-legendary: var(--rarity-legendary);

  --radius-md: 12px;
  --radius-lg: 16px;
  --shadow-soft: 0 16px 40px rgba(0, 0, 0, 0.45);
  --shadow-card: 0 8px 24px rgba(0, 0, 0, 0.35);
  --spacing: 12px;
  --ui-scale: 1;
  --vh: 1vh;
}

* { box-sizing: border-box; }

html, body { height: 100%; overflow-y: auto; }

body {
  margin: 0;
  font-family: 'Inter', 'Segoe UI', system-ui, -apple-system, sans-serif;
  background: radial-gradient(circle at 20% 20%, rgba(79, 140, 255, 0.08), transparent 40%),
    radial-gradient(circle at 80% 10%, rgba(156, 39, 176, 0.08), transparent 35%),
    linear-gradient(160deg, #060912 0%, #04070f 45%, #050910 100%);
  color: var(--color-text);
  min-height: 100dvh;
  min-height: calc(var(--vh) * 100);
  font-size: calc(16px * var(--ui-scale));
}

input, select, textarea, button { font-size: 16px; }
button, a, .clickable { touch-action: manipulation; -webkit-tap-highlight-color: transparent; }

.full-height { height: 100dvh; height: calc(var(--vh) * 100); }

body.animations-off *,
body.animations-off *::before,
body.animations-off *::after {
  transition: none !important;
  animation: none !important;
}

.app-shell { display: flex; flex-direction: column; min-height: 100dvh; min-height: calc(var(--vh) * 100); }

.app-header {
  position: sticky;
  top: 0;
  z-index: 10;
  margin-left: 240px;
  width: calc(100% - 240px);
  display: grid;
  grid-template-columns: 240px 1fr 260px;
  align-items: center;
  padding: calc(10px + env(safe-area-inset-top)) 18px 14px 18px;
  background: rgba(13, 20, 34, 0.9);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  border-bottom: 1px solid var(--color-border);
  box-shadow: var(--shadow-soft);
}

.menu-toggle {
  display: none;
  align-items: center;
  justify-content: center;
  width: 38px;
  height: 38px;
  border-radius: 10px;
  border: 1px solid var(--color-border);
  background: rgba(255, 255, 255, 0.04);
  color: var(--color-text);
  cursor: pointer;
}

.brand-block { display: flex; flex-direction: column; gap: 4px; }
.brand-title { font-weight: 800; letter-spacing: 0.5px; }
.brand-sub { color: var(--color-muted); font-size: 0.9rem; }

.header-center { display: flex; flex-direction: column; gap: 8px; }
.identity { display: flex; align-items: center; gap: 8px; font-weight: 600; }

.pill {
  background: rgba(79, 140, 255, 0.12);
  border: 1px solid rgba(79, 140, 255, 0.4);
  border-radius: 999px;
  padding: 4px 10px;
  font-size: 0.9rem;
  color: var(--color-text);
}

.pill.soft { background: rgba(255, 255, 255, 0.05); border-color: rgba(255, 255, 255, 0.1); color: var(--color-muted); }
.muted { color: var(--color-muted); }

.bar-stack { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 8px; }
.bar-block { display: flex; flex-direction: column; gap: 4px; }
.bars { display: flex; flex-direction: column; gap: 6px; }
.bar {
  position: relative;
  background: #0d1422;
  border: 1px solid var(--color-border);
  border-radius: 10px;
  height: 12px;
  overflow: hidden;
}
.bar span { position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%); font-size: 0.75rem; color: #fff; }
.bar .fill {
  background: linear-gradient(90deg, #e53935, #ff7043);
  width: 50%;
  height: 100%;
  transition: width 0.3s ease-out;
}
.bar.mana .fill { background: linear-gradient(90deg, #2196f3, #26c6da); }
.bar.xp .fill { background: linear-gradient(90deg, #43a047, #7cb342); }
.bar.enemy .fill { background: linear-gradient(90deg, #26c6da, #1565c0); }
.bar.enemy.boss .fill { background: linear-gradient(90deg, #8e2de2, #4a00e0); }
.bar-label { font-size: 0.8rem; color: var(--color-muted); }
.hp-bar-fill { transition: width 0.3s ease-out; }

.resource-label { font-size: 0.8rem; color: var(--color-muted); }
.resource-bar { width: 100%; height: 10px; background: #0d1422; border-radius: 8px; border: 1px solid var(--color-border); overflow: hidden; }
.resource-bar-fill { height: 100%; width: 0%; transition: width 0.3s ease-out; }
.rage-bar-fill { background: linear-gradient(90deg, #aa0000, #ff3300); }
.resource-text { font-size: 0.75rem; color: var(--color-muted); }

.header-meta { display: flex; flex-direction: column; gap: 6px; align-items: flex-end; justify-content: center; }
.meta-line { color: var(--color-muted); font-size: 0.9rem; }
.meta-actions { display: flex; gap: 8px; }

.app-body { display: block; }
.sidebar {
  position: fixed;
  top: 0;
  left: 0;
  height: 100dvh;
  height: calc(var(--vh) * 100);
  width: 240px;
  background: var(--color-panel);
  border-right: 1px solid var(--color-border);
  padding: calc(16px + env(safe-area-inset-top)) calc(12px + env(safe-area-inset-right)) calc(16px + env(safe-area-inset-bottom))
    calc(12px + env(safe-area-inset-left));
  display: flex;
  flex-direction: column;
  gap: 8px;
  overflow: hidden;
  z-index: 100;
  transition: transform 0.25s ease;
}
.sidebar * { overflow: visible !important; }
.nav-title { color: var(--color-muted); font-size: 0.85rem; text-transform: uppercase; letter-spacing: 1px; padding: 6px 10px; }
.nav-item {
  background: transparent;
  border: 1px solid var(--color-border);
  color: var(--color-text);
  padding: 10px 12px;
  border-radius: var(--radius-md);
  cursor: pointer;
  text-align: left;
  transition: all 0.2s ease;
}
.nav-item:hover { border-color: var(--color-accent); box-shadow: 0 0 0 1px rgba(79, 140, 255, 0.25); }
.nav-item.is-active { background: rgba(79, 140, 255, 0.12); border-color: var(--color-accent); }

.main-content {
  padding: 16px 18px 18px;
  display: flex;
  flex-direction: column;
  gap: 18px;
  margin-left: 240px;
  height: 100dvh;
  height: calc(var(--vh) * 100);
  overflow-y: auto;
}
.view-header { margin-bottom: 12px; }

.player-header {
  display: flex;
  flex-direction: column;
  gap: 6px;
  padding: 8px 14px 10px;
  margin-bottom: 10px;
  border-radius: 12px;
  background: radial-gradient(circle at top left, #020617, #020617 40%, #020617 100%);
  border: 1px solid rgba(148,163,184,0.15);
}

.player-header-top { display: flex; align-items: center; gap: 16px; justify-content: space-between; }
.player-identity { display: flex; gap: 8px; align-items: center; }
.player-name { font-weight: 600; }
.player-badge { padding: 2px 8px; border-radius: 999px; font-size: 0.75rem; border: 1px solid rgba(148,163,184,0.3); }
.player-core-stats { display: flex; flex-wrap: wrap; gap: 10px; font-size: 0.8rem; }
.player-stats-toggle { font-size: 0.75rem; padding: 4px 8px; border-radius: 999px; border: 1px solid rgba(148,163,184,0.3); background: transparent; cursor: pointer; }
.player-stats-details { margin-top: 6px; padding-top: 6px; border-top: 1px solid rgba(30,41,59,0.9); }
.stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(130px, 1fr)); gap: 6px 14px; font-size: 0.78rem; }
.stat-cell .label { opacity: 0.7; margin-right: 4px; }
.stat-cell .value { font-weight: 500; }

.main-panel { display: none; }
.main-panel.is-visible { display: block; }
.section-title { font-size: 1.15rem; font-weight: 700; }
.section-sub { color: var(--color-muted); }

.view-grid { display: grid; gap: 12px; }
.combat-grid { grid-template-columns: 320px 1fr 420px; align-items: start; }

.panel { background: var(--color-panel); border: 1px solid var(--color-border); border-radius: var(--radius-lg); padding: 14px; box-shadow: var(--shadow-card); }
.card { background: var(--color-bg-elevated); }
.card-soft { background: var(--color-panel-strong); border: 1px dashed var(--color-border); }

.panel-header { display: flex; align-items: center; justify-content: space-between; gap: 8px; margin-bottom: 8px; }
.panel-header h3 { margin: 0; }
.zone-travel-status { display: flex; flex-direction: column; gap: 4px; align-items: flex-end; }

.badge { display: inline-flex; align-items: center; gap: 4px; padding: 4px 10px; border-radius: 999px; background: rgba(255, 255, 255, 0.06); color: var(--color-text); font-size: 0.85rem; border: 1px solid var(--color-border); }
.badge.tier { background: rgba(79, 140, 255, 0.12); border-color: var(--color-accent); font-weight: 700; }

.zone-card-list { display: flex; gap: 10px; flex-wrap: nowrap; overflow-x: auto; padding-bottom: 4px; }
.zone-card { background: var(--color-panel-strong); border-radius: var(--radius-lg); border: 1px solid var(--color-border); padding: 10px 14px; min-width: 150px; text-align: left; cursor: pointer; transition: background 0.15s ease, border-color 0.15s ease, transform 0.1s ease; color: var(--color-text); }
.zone-card:hover:not(.zone-card--locked):not(.zone-card--active) { border-color: rgba(96, 165, 250, 0.7); transform: translateY(-1px); }
.zone-card--active { border-color: var(--color-accent); background: rgba(15, 23, 42, 0.95); }
.zone-card--locked { opacity: 0.55; cursor: not-allowed; }
.zone-card .zone-name { font-weight: 700; }
.zone-card .zone-level { color: var(--color-muted); font-size: 0.85rem; }
.zone-card .zone-mats { font-size: 0.75rem; color: var(--color-muted); }
.zone-card .zone-locked-label { font-size: 0.75rem; color: #f87171; margin-top: 6px; }
.epic-action-wrap { margin-top: 12px; padding: 12px; background: var(--color-bg-elevated); border-radius: var(--radius-lg); box-shadow: var(--shadow-soft); }
.epic-actions-head { display: flex; align-items: baseline; justify-content: space-between; gap: 8px; margin-bottom: 6px; }
.epic-actions-summary { white-space: nowrap; }
.panel-subhead { display: flex; align-items: center; justify-content: space-between; margin-bottom: 6px; gap: 8px; }
.epic-actions { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 8px; }
.epic-actions button { width: 100%; justify-content: center; display: inline-flex; align-items: center; gap: 6px; }

.gate-boss-row { display: flex; align-items: center; gap: 10px; margin: 8px 0 4px; }
.gate-boss-btn { padding: 8px 12px; border-radius: var(--radius-lg); }
.gate-boss-info { flex: 1; }
.action-pill { display: inline-flex; align-items: center; gap: 4px; padding: 3px 8px; border-radius: 999px; background: rgba(255,255,255,0.06); font-size: 0.75rem; }
.zone-controls { display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 8px; margin-top: 10px; }
.auto-row { display: flex; flex-direction: column; gap: 4px; color: var(--color-muted); }
.auto-summary { min-height: 18px; }
.auto-actions { display: flex; gap: 8px; flex-wrap: wrap; margin-top: 6px; }

.life-skill.on-cooldown { display: none; }

.event { margin-top: 10px; padding: 10px; border-radius: var(--radius-md); min-height: 80px; color: var(--color-text); }

.center { display: flex; flex-direction: column; gap: 8px; }
.enemy-card { padding: 10px; background: var(--color-panel-strong); border-radius: var(--radius-md); min-height: 60px; border: 1px solid var(--color-border); }
.bars.inline .bar { margin-top: 2px; }

.status-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px; }
.status-icons { display: flex; gap: 6px; flex-wrap: wrap; min-height: 20px; }
.status-icons .icon { padding: 4px 6px; border-radius: 8px; background: #1b2335; border: 1px solid #2d3a52; font-size: 11px; }
.status-icons .dot { color: #f56565; }
.status-icons .buff { color: #68d391; }
.status-icons .debuff { color: #ed8936; }
.status-icons .cc { color: #90cdf4; }

.info { color: var(--color-muted); }
.log { flex: 1; background: var(--color-panel-strong); border: 1px solid var(--color-border); padding: 10px; border-radius: var(--radius-md); overflow-y: auto; min-height: 160px; -webkit-overflow-scrolling: touch; }
.log .crit { color: #f6ad55; font-weight: bold; }
.log .status { color: #63b3ed; }
.log .boss { color: #f472b6; }

.nav-log { display: flex; flex-direction: column; gap: 6px; margin-top: auto; }
.nav-log-title { font-size: 0.85rem; color: var(--color-muted); padding: 0 6px; }
.nav-log-body { max-height: 220px; min-height: 120px; }

.action-bar { display: grid; grid-template-columns: 1fr; gap: 8px; }
.skill-actions { display: flex; gap: 8px; flex-wrap: wrap; }
.skill-bar { display: flex; gap: 8px; align-items: stretch; width: 100%; }
.skill-slot { position: relative; flex: 1 0 110px; min-width: 110px; padding: 8px; background: var(--color-panel-strong); border: 1px solid var(--color-border); border-radius: var(--radius-md); display: grid; grid-template-rows: auto auto; gap: 2px; justify-items: start; overflow: hidden; }
.skill-slot.disabled { opacity: 0.45; cursor: not-allowed; }
.skill-slot.no-resource { box-shadow: 0 0 0 1px rgba(244, 114, 182, 0.4); }
.skill-slot .skill-icon { width: 28px; height: 28px; border-radius: 8px; background: linear-gradient(135deg, rgba(79,140,255,0.4), rgba(148,163,184,0.2)); display: grid; place-items: center; font-weight: 700; color: var(--color-text); }
.skill-slot .skill-label { font-size: 12px; color: var(--color-text); }
.skill-slot .skill-meta { font-size: 11px; color: var(--color-muted); }
.skill-slot .cooldown { position: absolute; top: 2px; right: 4px; font-size: 10px; }
.cooldown-overlay { position: absolute; inset: 0; background: rgba(0,0,0,0.45); pointer-events: none; height: 0%; transition: height 0.2s linear; }

.tabs { display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 6px; margin-bottom: 10px; }
.tabs button {
  background: rgba(255, 255, 255, 0.04);
  border: 1px solid var(--color-border);
  color: var(--color-text);
  padding: 10px 12px;
  border-radius: var(--radius-md);
  cursor: pointer;
  transition: all 0.2s ease;
}
.tabs button.active { border-color: var(--color-accent); box-shadow: 0 0 0 1px rgba(79, 140, 255, 0.4); background: rgba(79, 140, 255, 0.1); }

@media (max-width: 1100px) {
  .app-header { grid-template-columns: 1fr; gap: 10px; align-items: flex-start; }
  .header-meta { align-items: flex-start; }
  .app-body { grid-template-columns: 1fr; }
  .sidebar { position: fixed; top: 0; left: 0; height: 100dvh; height: calc(var(--vh) * 100); width: 240px; flex-direction: column; flex-wrap: nowrap; overflow: hidden; border-right: 1px solid var(--color-border); border-bottom: none; background: var(--color-panel); }
  .sidebar .nav-item { white-space: nowrap; }
  .content { padding: 14px; }
  .combat-grid { grid-template-columns: 1fr; }
}

@media (max-width: 720px) {
  .panel { padding: 12px; }
  .view-section { padding: 12px; }
  .bar-stack { grid-template-columns: 1fr; }
  .panel-header { flex-direction: column; align-items: flex-start; }
  .zone-card-list { gap: 8px; }
  .epic-actions { grid-template-columns: repeat(auto-fill, minmax(130px, 1fr)); }
  .tabs { grid-template-columns: repeat(auto-fit, minmax(100px, 1fr)); }
}

button {
  touch-action: manipulation;
}
.tab { display: none; }
.tab.active { display: block; }

.panel-split { display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 12px; }

#equipment-slots, #inventory-list, #egg-list { display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 8px; }
.shop-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(170px, 1fr)); gap: 10px; }
.item, .slot, .egg, .dragon-card, .skill-node, .shop-card, .recipe-card, .life-action, .material, .socket-card { background: var(--color-panel-strong); border: 1px solid var(--color-border); padding: 8px; border-radius: var(--radius-md); position: relative; }
.slot { min-height: 80px; }
.shop-card { display: flex; flex-direction: column; gap: 6px; }

.rarity-common { border-color: var(--color-common); }
.rarity-uncommon { border-color: var(--color-uncommon); }
.rarity-rare { border-color: var(--color-rare); }
.rarity-epic { border-color: var(--color-epic); }
.rarity-legendary { border-color: var(--color-legendary); }
.name.common { color: var(--color-common); }
.name.uncommon { color: var(--color-uncommon); }
.name.rare { color: var(--color-rare); }
.name.epic { color: var(--color-epic); }
.name.legendary { color: var(--color-legendary); }

body.colorblind-mode {
  --rarity-common: #b0b0b0;
  --rarity-uncommon: #006d32;
  --rarity-rare: #004f9f;
  --rarity-epic: #5a199a;
  --rarity-legendary: #8b4513;
  --color-common: var(--rarity-common);
  --color-uncommon: var(--rarity-uncommon);
  --color-rare: var(--rarity-rare);
  --color-epic: var(--rarity-epic);
  --color-legendary: var(--rarity-legendary);
}
.name.uncommon { color: var(--color-uncommon); }
.name.rare { color: var(--color-rare); }
.name.epic { color: var(--color-epic); }
.name.legendary { color: var(--color-legendary); }
.better-arrow { color: var(--color-success); font-weight: bold; margin-left: 6px; }

.filters { display: flex; flex-wrap: wrap; gap: 12px; margin-bottom: 8px; }
.filters label { font-size: 0.9rem; color: var(--color-muted); display: flex; flex-direction: column; gap: 4px; }
.filters select { background: var(--color-panel-strong); color: var(--color-text); border: 1px solid var(--color-border); padding: 6px; border-radius: 8px; }
.filters .wide { align-self: flex-end; padding: 8px 12px; background: transparent; color: var(--color-text); border: 1px solid var(--color-border); border-radius: 10px; cursor: pointer; }

.life-layout { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 12px; align-items: flex-start; }
.life-detail-col { order: -1; display: flex; flex-direction: column; gap: 8px; }
.life-meta-col { display: flex; flex-direction: column; gap: 10px; }
.life-skill { padding: 10px; border: 1px solid var(--color-border); border-radius: var(--radius-md); margin-bottom: 6px; background: var(--color-panel-strong); cursor: pointer; transition: transform 0.12s ease, box-shadow 0.12s ease, opacity 0.2s ease; position: relative; }
.life-skill:hover:not(.on-cooldown) { transform: translateY(-1px); box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.06); }
.life-skill.active { border-color: var(--color-success); box-shadow: 0 0 0 1px rgba(102, 187, 106, 0.35); }
.life-skill.on-cooldown { opacity: 0.6; cursor: not-allowed; }
.life-skill .life-skill-cooldown { font-size: 0.78rem; color: var(--color-muted); margin-top: 4px; }
.life-bar { position: relative; background: var(--color-panel); border: 1px solid var(--color-border); border-radius: 8px; height: 12px; margin-top: 4px; }
.life-bar .fill { background: linear-gradient(90deg, #2196f3, #64b5f6); height: 100%; width: 0; transition: width 0.3s ease; }
.life-bar span { position: absolute; left: 50%; top: -2px; transform: translate(-50%, -100%); font-size: 10px; color: var(--color-muted); }
.life-detail-head { position: sticky; top: 0; z-index: 2; background: var(--color-panel-strong); padding: 10px 12px; border-radius: var(--radius-md); box-shadow: var(--shadow-soft); display: flex; align-items: flex-start; justify-content: space-between; gap: 10px; margin-bottom: 10px; }
.life-detail-title h4 { margin: 0; }
.life-detail-title .muted { margin-top: 4px; display: block; }
.life-detail-head .primary { white-space: nowrap; }
.materials { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 8px; margin-top: 8px; }
.material .tiny { font-size: 0.75rem; opacity: 0.85; }
.recipe-card.locked { opacity: 0.6; border-style: dashed; }
#refine-panel, #perk-panel { margin-top: 10px; }
.perk { padding: 6px; margin: 4px 0; background: rgba(255, 255, 255, 0.03); border-radius: 8px; font-size: 0.9rem; border: 1px solid var(--color-border); }
.perk.unlocked { border-color: var(--color-success); box-shadow: 0 0 0 1px rgba(102, 187, 106, 0.25); }

#socket-panel { margin-top: 10px; border-top: 1px solid var(--color-border); padding-top: 8px; }
.socket-card { margin-bottom: 6px; padding: 8px; }
.socket-target { display: flex; justify-content: space-between; align-items: center; background: rgba(255, 255, 255, 0.04); padding: 8px; border-radius: 8px; margin-top: 6px; }
.badge { background: rgba(255, 255, 255, 0.05); }

.branch-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 12px; }
.skill-branch { padding-left: 14px; border-left: 2px dashed var(--color-border); position: relative; }
.skill-branch::before { content: ''; position: absolute; left: -9px; top: 10px; bottom: 10px; width: 6px; background: linear-gradient(var(--color-border), rgba(255, 255, 255, 0)); border-radius: 6px; opacity: 0.7; }
.skill-node { cursor: pointer; border-left: 4px solid #455a64; margin: 8px 0; position: relative; padding-left: 10px; }
.skill-node::before { content: ''; position: absolute; left: -10px; top: 50%; width: 10px; height: 2px; background: var(--color-border); }
.skill-node.unlocked { border-color: var(--color-success); box-shadow: 0 0 8px rgba(102, 187, 106, 0.4); }

.skill-points-row { margin-bottom: 10px; font-weight: 600; }
.skill-category { border-radius: 12px; border: 1px solid rgba(148, 163, 184, 0.18); margin-bottom: 8px; overflow: hidden; }
.skill-category-header { width: 100%; background: #020617; padding: 8px 12px; color: #e5e7eb; border: none; outline: none; display: flex; align-items: center; justify-content: space-between; cursor: pointer; }
.skill-category-header:hover { background: #02081f; }
.skill-category-body { padding: 6px 8px 8px; }
.skill-category-body.is-collapsed { display: none; }
.skill-list .skill-row { border-radius: 10px; padding: 8px 12px; border: 1px solid rgba(55, 65, 81, 0.7); background: #020617; margin-bottom: 4px; cursor: pointer; transition: border-color 0.12s ease, background 0.12s ease; }
.skill-list .skill-row:hover { border-color: rgba(34, 197, 94, 0.8); background: #020b1a; }
.skill-title { font-weight: 600; }
.skill-effects { font-size: 0.85rem; opacity: 0.9; margin: 2px 0; }
.skill-cost { font-size: 0.78rem; color: var(--color-muted); }
.category-toggle-indicator { font-size: 0.75rem; opacity: 0.7; }

.action-bar button, .tabs button, .nav-item, .filters .wide, .shop-header button, #fight-btn, #boss-btn, #auto-btn, #sell-filtered, #prestige-btn, #reset-btn, #refresh-shop {
  font-weight: 600;
}

.shop-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
.shop-header button { margin-right: 6px; }

.event button { margin-right: 4px; }

button { font-family: inherit; }
button.primary { background: linear-gradient(120deg, var(--color-accent), #6ca7ff); border: none; color: #fff; padding: 10px 12px; border-radius: var(--radius-md); cursor: pointer; box-shadow: 0 6px 16px rgba(79, 140, 255, 0.35); }
button.warning { background: linear-gradient(120deg, #ffb74d, #ff9800); border: none; color: #0b0f18; padding: 10px 12px; border-radius: var(--radius-md); cursor: pointer; }
button.ghost { background: rgba(255, 255, 255, 0.04); border: 1px solid var(--color-border); color: var(--color-text); padding: 8px 12px; border-radius: var(--radius-md); cursor: pointer; }
button.danger { border-color: var(--color-danger); color: var(--color-danger); }
button:disabled { opacity: 0.5; cursor: not-allowed; }

.modal { position: fixed; inset: 0; background: rgba(0, 0, 0, 0.8); display: flex; align-items: center; justify-content: center; z-index: 20; }
.modal-content { background: var(--color-panel); padding: 20px; border-radius: var(--radius-lg); width: 440px; box-shadow: var(--shadow-soft); }
.class-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 10px; }
.class-card { padding: 12px; border: 1px solid var(--color-border); border-radius: var(--radius-md); background: var(--color-panel-strong); cursor: pointer; transition: border-color 0.2s ease, transform 0.2s ease; }
.class-card:hover { border-color: var(--color-accent); transform: translateY(-2px); }

.settings-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 12px; }
.setting-card {
  padding: 12px;
  border: 1px solid var(--color-border);
  border-radius: var(--radius-md);
  background: var(--color-panel-strong);
  cursor: pointer;
  display: flex;
  flex-direction: column;
  gap: 6px;
  transition: transform 0.12s ease, box-shadow 0.12s ease;
}

.setting-card:hover { transform: translateY(-1px); box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25); }
.setting-title-row { display: flex; align-items: center; justify-content: space-between; gap: 8px; }
.setting-value { color: var(--color-muted); font-size: 0.9rem; }
.setting-title { font-weight: 700; margin-bottom: 4px; }

.epic-meta { display: flex; align-items: center; justify-content: space-between; gap: 12px; }
.epic-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 10px; }
.system-card { padding: 12px; border: 1px solid var(--color-border); border-radius: var(--radius-md); background: var(--color-panel-strong); box-shadow: var(--shadow-soft); }
.system-card h5 { margin: 0 0 4px 0; }
.system-card .small { margin-bottom: 6px; display: block; }
.badge-tier { display: inline-flex; align-items: center; padding: 2px 6px; border-radius: 999px; font-size: 11px; background: rgba(255,255,255,0.05); border: 1px solid var(--color-border); }
.badge-tier.t1 { border-color: var(--color-common); color: var(--color-common); }
.badge-tier.t2 { border-color: var(--color-uncommon); color: var(--color-uncommon); }
.badge-tier.t3 { border-color: var(--color-rare); color: var(--color-rare); }
.badge-tier.t4 { border-color: var(--color-epic); color: var(--color-epic); }
.badge-tier.t5 { border-color: var(--color-legendary); color: var(--color-legendary); }
.timer-text { font-size: 12px; color: var(--color-muted); }
.history-log { max-height: 200px; overflow-y: auto; display: grid; gap: 4px; }
.history-log div { font-size: 12px; color: var(--color-muted); }
.quest-list { display: grid; gap: 8px; }
.quest-entry { padding: 10px; border: 1px solid var(--color-border); border-radius: var(--radius-md); background: var(--color-panel-strong); }
.quest-entry .progress { height: 6px; background: rgba(255,255,255,0.08); border-radius: 6px; overflow: hidden; margin-top: 6px; }
.quest-entry .progress .fill { height: 100%; background: linear-gradient(120deg, var(--color-accent), #6ca7ff); }
.socket-summary { display: flex; gap: 8px; flex-wrap: wrap; }
.breeding-row, #enhance-panel, #fusion-panel { display: flex; gap: 8px; align-items: center; flex-wrap: wrap; margin: 8px 0; }
select { background: var(--color-panel); color: var(--color-text); border: 1px solid var(--color-border); border-radius: var(--radius-md); padding: 6px; }

.gear-tooltip {
  position: fixed;
  min-width: 220px;
  max-width: 320px;
  background: #020617;
  border-radius: 10px;
  padding: 8px 10px;
  box-shadow: 0 12px 30px rgba(0,0,0,0.6);
  font-size: 0.8rem;
  z-index: 9999;
  pointer-events: none;
  border: 1px solid rgba(255,255,255,0.06);
}
.gear-tooltip .item-name { font-weight: 600; margin-bottom: 4px; }
.gear-tooltip .item-rarity { font-size: 0.7rem; opacity: 0.8; text-transform: uppercase; }
.gear-tooltip .stat-line { display: flex; justify-content: space-between; }
.gear-tooltip hr { border: none; border-top: 1px solid rgba(255,255,255,0.08); margin: 6px 0; }

.combat-action-bar { display: none; }
.combat-action-track { display: flex; gap: 8px; align-items: center; }
.combat-action-bar button { flex: 0 0 auto; white-space: nowrap; min-height: 44px; }
.combat-action-bar { -ms-overflow-style: none; scrollbar-width: none; }
.combat-action-bar::-webkit-scrollbar { display: none; }


body[data-mobile="true"] .app-header {
  margin-left: 0;
  width: 100%;
  grid-template-columns: 1fr;
  padding: 10px 12px;
  gap: 8px;
}

body[data-mobile="true"] .menu-toggle { display: inline-flex; }

body[data-mobile="true"] .sidebar {
  width: 80%;
  max-width: 320px;
  height: calc(var(--vh) * 100);
  transform: translateX(-100%);
  box-shadow: var(--shadow-card);
  padding: calc(12px + env(safe-area-inset-top)) 14px calc(12px + env(safe-area-inset-bottom)) 14px;
  gap: 10px;
  pointer-events: none;
}

body[data-mobile="true"] .sidebar.open {
  transform: translateX(0);
  pointer-events: auto;
}

body[data-mobile="true"] .sidebar .nav-item {
  min-height: 44px;
}

body[data-mobile="true"] .main-content {
  margin-left: 0;
  height: auto;
  min-height: calc(var(--vh) * 100);
  padding: 12px;
  gap: 12px;
}

body[data-mobile="true"] .panel { padding: 12px; }
body[data-mobile="true"] .player-core-stats { gap: 6px; font-size: 0.78rem; }
body[data-mobile="true"] .action-bar { flex-wrap: wrap; }
body[data-mobile="true"] .skill-bar { flex-wrap: wrap; gap: 6px; }
body[data-mobile="true"] .skill-slot { flex: 1 0 45%; min-width: 130px; padding: 10px; }
body[data-mobile="true"] #equipment-slots,
body[data-mobile="true"] #inventory-list,
body[data-mobile="true"] #egg-list { grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); }
body[data-mobile="true"] button { min-height: 44px; }
body[data-mobile="true"] .inventory-grid { grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); }
body[data-mobile="true"] .nav-log { margin-top: 12px; }
body[data-mobile="true"] #combat-action-bar.active {
  display: block;
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  padding: 10px 12px calc(12px + env(safe-area-inset-bottom));
  background: rgba(12, 17, 30, 0.95);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  box-shadow: 0 -6px 20px rgba(0, 0, 0, 0.45);
  overflow-x: auto;
  overflow-y: hidden;
  -webkit-overflow-scrolling: touch;
  z-index: 110;
}
body[data-mobile="true"] #combat-action-bar.active .combat-action-track { flex-wrap: nowrap; }
body[data-mobile="true"].combat-bar-active .main-content { padding-bottom: 160px; }
body[data-mobile="true"][data-orientation="landscape"] .sidebar { width: 55%; max-width: 300px; }
body[data-mobile="true"][data-orientation="portrait"] .sidebar { width: 80%; max-width: 320px; }
body[data-mobile="true"][data-orientation="landscape"] #combat-action-bar.active {
  padding-bottom: calc(8px + env(safe-area-inset-bottom));
}


@media (max-width: 1200px) {
  .combat-grid { grid-template-columns: 1fr; }
  .app-header { grid-template-columns: 1fr; gap: 12px; position: static; }
  .sidebar { position: fixed; top: 0; left: 0; height: 100dvh; height: calc(var(--vh) * 100); width: 240px; flex-direction: column; flex-wrap: nowrap; }
  .app-body { grid-template-columns: 1fr; }
}

@media (max-width: 720px) {
  .main-content { padding: 12px; }
  .nav-item { flex: 1 1 calc(50% - 8px); }
  .sidebar { gap: 6px; }
}
